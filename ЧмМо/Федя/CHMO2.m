clc; 
clear all;
close all; 

% Параметры сетки
N = 100; % Число узлов
x = linspace(0, 2, N)'; % Интервал [0, 2]
h = x(2) - x(1);

% Матрицы для разностной схемы
A = zeros(N, N);
b = zeros(N, 1);

% Заполнение матрицы A и вектора b
for i = 2:N-1
    % Коэффициенты разностной схемы
    A(i, i-1) = 1 / h^2;
    A(i, i)   = -2 / h^2 + sinh(x(i)); % y'' + sinh(x)*y = 0
    A(i, i+1) = 1 / h^2;
    b(i) = 0; % Правая часть уравнения равна 0
end

% Граничные условия
A(1, 1) = 1; b(1) = 0;   % y(0) = 0
A(N, N) = 1; b(N) = 1;   % y(2) = 1

% Решение системы
y = A \ b;

% Вывод значений в заданных точках
x_output = [0, 0.5, 1, 1.5, 2];
y_output = interp1(x, y, x_output, 'spline');

disp('Метод конечных разностей:');
disp('x      y(x)');
disp([x_output', y_output']);

% Проверка краевых условий
fprintf('\nПроверка краевых условий:\n');
fprintf('y(0) = %.6f (должно быть 0.000000)\n', y(1));
fprintf('y(2) = %.6f (должно быть 1.000000)\n', y(end));

% График решения
plot(x, y, 'LineWidth', 2);
xlabel('x'); 
ylabel('y');
title('Решение краевой задачи: y'''' + y \cdot sinh(x) = 0');
grid on;